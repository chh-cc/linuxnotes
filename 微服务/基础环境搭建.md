# 基础环境搭建

## Eureka

dockerfile:

```dockerfile
FROM yi/centos7-jdk8u151
MAINTAINER Leon
ADD dm-discovery-eureka-1.0-SNAPSHOT.jar /usr/local/dm-discovery-eureka-1.0-SNAPSHOT.jar
WORKDIR /usr/local
RUN bash -c 'touch dm-discovery-eureka-1.0-SNAPSHOT.jar'
ENTRYPOINT ["java","-server","-Xms64m","-Xmx128m","-jar","dm-discovery-eureka-1.0-SNAPSHOT.jar"]
```

docker-compose:

```yaml
version: '2'
services:
  #注册中心
  eureka-server1:
    build: /home/px2/temp/docker-compose/eureka
    mem_limit: 512M
    ports:
     - 7666:7776
  eureka-server2:
    build: /home/px2/temp/docker-compose/eureka
    mem_limit: 512M
    ports:
     - 7667:7776
networks: 
   default:
      external: 
        name: envdm
```

启动容器：

```shell
docker-compose up -d
```

## 服务体系

docker-compose：

```yaml
version: '2'
services:
  #1.Redis
  redis:
    build: /home/px2/envdm/Redis/
    mem_limit: 300M
    ports:
     - "6379:6379"
  #3-1.Elasticsearch
  elasticsearch:
    build: /home/px2/envdm/Elasticsearch/
    mem_limit: 300M
    ports:
     - "9200:9200"
     - "9300:9300"
  #3-2.Logstash
  logstash:
    build: /home/px2/envdm/Logstash/
    mem_limit: 300M
  #3-3.Kibana
  kibana:
    build: /home/px2/envdm/Kibana/
    mem_limit: 300M
    ports:
     - "5601:5601"
  #4.Kafka
  kafka:
    build: /home/px2/envdm/Kafka/
    mem_limit: 300M
    ports:
     - "9092:9092"

  #5.Nexus
  nexus:
    build: /home/px2/envdm/Nexus/
    mem_limit: 300M
    ports:
     - "8081:8081"
  #6.MySQL
  mysql:
    build: /home/px2/envdm/MySQL/
    mem_limit: 500M
    ports:
     - "3306:3306"
  #7.Sonar
  sonar:
    build: /home/px2/envdm/Sonar/
    mem_limit: 300M
    ports:
     - "9000:9000"

  #8.RabbitMQ
  rabbitmq:
    build: /home/px2/envdm/RabbitMQ/
    mem_limit: 300M
    ports:
     - "5672:5672"
  #9.Mycat
  mycat:
    build: /home/px2/envdm/Mycat/
    mem_limit: 300M
    ports:
     - "8066:8066"

  #10.Jenkins
  jenkins:
    build: /home/px2/envdm/Jenkins/
    mem_limit: 1024M
    ports:
     - "8899:8080"
  #11.Tengine-2.2.1
  tengine:
    build: /home/px2/envdm/Tengine/
    mem_limit: 200M
    ports:
     - "8888:80"   

networks: 
   default:
      external: 
        name: envdm
```

