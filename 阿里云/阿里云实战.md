# 阿里云实战

## 阿里云架构

<img src="https://gitee.com/c_honghui/picture/raw/master/img/20210223211344.png" alt="image-20210223211337123" style="zoom:80%;" />

相关名称：

| 名词   | 含义                                         |
| ------ | -------------------------------------------- |
| slb    | 负载均衡                                     |
| 安全组 | 防火墙（默认是白名单 默认是拒绝）            |
| ecs    | 云服务器                                     |
| vpc    | 虚拟局域网                                   |
| rds    | 云数据库                                     |
| nas    | 文件存储                                     |
| oss    | 对象存储                                     |
| 实例   | 1台服务器/1个功能 每个实例都有自己的名称和id |
| 释放   | 删除                                         |
| eip    | 弹性公网ip                                   |

## ECS云服务器

### 创建ecs

1. 点击创建实例

2. 计费方式

   - **包年包月**	企业默认
   - 按量（按小时）1元1小时  测试，临时增加服务
   - 抢占式实例（0.1元1小时）

3. 地域（region）和可用区（zone）

   地域/地区：北京、上海、杭州，不同地区内网不通

   可用区：同一个地区不同机房，可**内网互通**

4. 实例配置

   通用型

5. 镜像

   | 镜像分类   | 含义                           |
   | ---------- | ------------------------------ |
   | 公共镜像   | 阿里云官网创建好的             |
   | 自定义镜像 | 通过快照→镜像→安装系统         |
   | 共享镜像   | 别人共享给你的                 |
   | 镜像市场   | 别人创建的镜像共享出来一起使用 |

   安全加固：

   默认给你安装云盾，监控cpu、内存、网络，检查漏洞

6. 存储

   系统盘

   数据盘

7. 网络vpc

   <img src="https://gitee.com/c_honghui/picture/raw/master/img/20210223224811.png" alt="image-20210223224811443" style="zoom: 80%;" />

   购买/创建一个路由器+交换机

   <img src="https://gitee.com/c_honghui/picture/raw/master/img/20210223223448.png" alt="image-20210223223448876" style="zoom:67%;" />

   创建专有网络vpc

   <img src="https://gitee.com/c_honghui/picture/raw/master/img/20210223223526.png" alt="image-20210223223526026" style="zoom:67%;" />

   <img src="https://gitee.com/c_honghui/picture/raw/master/img/20210223224533.png" alt="image-20210223224533743" style="zoom:67%;" />

   创建交换机（可添加多个）

   <img src="https://gitee.com/c_honghui/picture/raw/master/img/20210223224628.png" alt="image-20210223224628452" style="zoom:67%;" />

   点击小刷新图标

   <img src="https://gitee.com/c_honghui/picture/raw/master/img/20210223224934.png" alt="image-20210223224934529" style="zoom:80%;" />

   

8. 公网IP

   按固定带宽

   单向收取流出流量费用，每小时扣费

9. 安全组

10. 设置系统密码

11. 创建完成

12. 手动拍摄快照

    | 硬盘   | 作用                           |
    | ------ | ------------------------------ |
    | 系统盘 | 系统盘快照可以用来做自定义镜像 |
    |        |                                |
    
    点击实例:
    
    ![image-20210224094320502](https://gitee.com/c_honghui/picture/raw/master/img/20210224094320.png)
    
    创建系统盘快照:
    
    ![image-20210224095014524](https://gitee.com/c_honghui/picture/raw/master/img/20210224095014.png)
    
    <img src="https://gitee.com/c_honghui/picture/raw/master/img/20210224095550.png" alt="image-20210224095550778" style="zoom:80%;" />
    
    创建完成后,如需要使用可以回滚硬盘

13. 自动拍摄快照

    创建快照策略:

    ![image-20210224100915225](https://gitee.com/c_honghui/picture/raw/master/img/20210224100915.png)

    ![image-20210224101215220](https://gitee.com/c_honghui/picture/raw/master/img/20210224101215.png)

    ![image-20210224101315285](https://gitee.com/c_honghui/picture/raw/master/img/20210224101315.png)

    执行快照策略:

    ![image-20210224101432608](https://gitee.com/c_honghui/picture/raw/master/img/20210224101432.png)

    ![image-20210224101725140](https://gitee.com/c_honghui/picture/raw/master/img/20210224101725.png)

    ![image-20210224102620857](https://gitee.com/c_honghui/picture/raw/master/img/20210224102620.png)

14. 快照升级为包年包月

    

15. 挂在数据盘

    ```shell
    mkfs.xfs /dev/vdb
    mkdir -p /data
    mount /dev/vdb /data
    df -h
    ```

16. 添加云盘

    创建云盘：

    ![image-20210224111720531](https://gitee.com/c_honghui/picture/raw/master/img/20210224111720.png)

    创建完后把云盘挂载到ecs实例：

    ![image-20210224112423280](https://gitee.com/c_honghui/picture/raw/master/img/20210224112423.png)

    ![image-20210224112529377](https://gitee.com/c_honghui/picture/raw/master/img/20210224112529.png)

    登陆服务器查看硬盘是否添加上：

    ```shell
    fdisk -l
    ```

    

17. 克隆

    关于镜像：

    - 镜像免费使用
    - 创建的镜像默认只在当前地区使用，可以把当前区域的镜像复制到其他区域，点击复制镜像

    关于克隆：

    - 准备环境，并且能开机自启
    - 创建快照
    - 根据快照创建自定义镜像
    - 创建ecs

18. 安全组

    ![image-20210224120759210](https://gitee.com/c_honghui/picture/raw/master/img/20210224120759.png)

    添加安全组规则，随便找一个规则点击克隆：

    ![image-20210224224804229](https://gitee.com/c_honghui/picture/raw/master/img/20210224224811.png)

    

19. 