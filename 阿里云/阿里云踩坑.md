#### 关于发票

```
如果你的公司或者客户要求，充值多少就打出多少票，你就惨了，因为阿里云不支持，一定要和财务说好，咬死阿里云不支持，绝对凑不上他要的整数！
```

#### 手动扩容

```
手动扩容方案很好，很省钱，但一周一次能接受，多了就改下架构就好
# 案例
平时2个常规PHP节点，每周五秒杀，再扩容出5个PHP，5个RDS只读实例，100M带宽，3~4小时时间，整体花费100元左右，注意，读写分离是新地址，不要轻信看RDS读写分离创建完成的状态，那玩意有延时。
```

#### 证书合并

```
阿里云不提供haproxy整数，haproxy证书合并，下载nginx证书，使用编辑器打开两个文件，将key中的内容，追加到pem的文件中即可
```

#### CDN+OSS还是OSS+下行

```
OSS+下行流量本质就是CDN+OSS，费用稍微贵一些
```

#### 白名单采坑（自动IP）

```
# 案例
每次手动扩容，阿里云的ECS的IP都会自增，突然有一次扩容，发现业务链接不上数据库了，原来是白名单是只加了初始IP段，随着IP递增，网段数据增加了192.168.1.0/24->192.168.2.0/24，所以白名单最好是16位，192.168.0.0/16
```

#### RDS初始化故障

```
如果扩容RDS的只读实例，点击创建时报错，千万不要再次点击，先去看看是不是真的创建完成，一般RDS初始化需要15分钟，如果超过20分钟，就不太正常，需要下加急工单
```

#### Windows初始化异常

```
1. 一次扩容5台，有一台初始化就很慢，但也启动了
2. 把业务转到这台上，就是出问题
3. 重启后，好了
```

#### 快照坑不能快照磁盘

```
# 请备份好ECS中的数据（代码和数据库），因为这个快照只支持回滚
# 案例
ECS中有数据被删除，没有备份，怎么恢复？
1. 对当前系统做快照
2. 关闭ECS，回滚到之前快照
3. 拷贝数据，再回滚到最新的快照
4.（如果是单独一块磁盘），记得系统中关闭所有开机启动，再做1~3，否则如果有svn的业务，会造成数据冲突
```

#### 域名

```
1. 如果你做外包项目，请你一定要确认要客户的域名在阿里云备案过，否则30天起
2. 域名可以在账户间转移
```

#### 自定义镜像

```
只能在相同的区域分享，北京分享不到张家口
```

#### 临时扩展带宽要提前

```
加入11点~14点申请加带宽，记得一定要提前，否则你只能申请11点~15点
```

#### 用阿里云的WAF，一定记得过滤waf回源IP

```
WAF ->网站设置->Web应用防火墙回源IP网段列表
# 案例
Nginx启用iphash和realip，但发现IP地址不对，realip中把waf回源的IP过滤掉即可
```

#### Windows服务器突然无法连接，重启恢复

```
Windows的DHCP的BUG，之前默认租期是1年，重新获取失败，就中断，现在调整为10年
所有Windows服务器都要 ipconfig /renew IP不会变化
```

#### 阿里云ECS发不出邮件

```
# 需要单独申请，很麻烦
https://www.cnblogs.com/axinno1/p/8303130.html
```