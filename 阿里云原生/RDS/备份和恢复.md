## 备份

[高可用版](https://help.aliyun.com/document_detail/127875.htm#concept-1443745)和[三节点企业版](https://help.aliyun.com/document_detail/51701.htm#concept-yqy-zvw-5db)实例：备份在备实例执行，不占用主实例CPU，不影响主实例性能。

可使用命令行或图形界面进行逻辑数据备份。仅限通过 RDS 管理控制台 或 OPEN API 进行物理备份。

### 备份的组成

数据备份和日志备份存放于阿里云提供的备份空间，**不占用实例的存储空间**。

**数据备份：**

可以恢复备份集所在时间点的数据。

不能关闭，最少一周两次，保留天数最少7天

**日志备份：**

可以关闭；

基于“数据备份+日志备份”，您可以恢复时间范围内**任意时间点**的数据



同一个binlog文件存在两份是因为主备实例都会生成binlog文件，通过实例编号进行区分

为什么备份任务会失败：

备份过程中执行DDL操作，会导致锁表，从而导致备份失败



1. 账号

   RDS不提供root或者sa权限

   每个实例仅可以创建一个高权限账号

   普通账号不能创建和管理其他账号

2. 连接

   如果云数据库RDS实例与云服务器处于不同的安全组，云服务器不能访问RDS。

   将设备IP地址添加到白名单

3. 备份

   RDS的备份由数据备份和日志备份组成。

   - **数据备份**：系统对数据进行备份，并生成备份集。您可以恢复备份集所在时间点的数据。
   - **日志备份**：也叫**增量备份**。开启日志备份后，基于“数据备份+日志备份”，您可以恢复时间范围内**任意时间点**的数据。

   备份方式：

   默认备份（物理或快照）：全量（数据）备份和增量（日志）备份

   DBS（逻辑）：可以跨地域跨账号

   备份期间不要执行DDL操作，避免锁表导致备份失败。

4. 恢复

   按时间点恢复是先将所选时间点前的一个全量数据备份恢复到实例，然后根据Binlog增量恢复数据到所选时间点。

   恢复全量数据：先恢复到新实例，再迁移到原实例

   恢复库表：

5. 迁移

6. 主从复制方式

   如果要求极高的响应速度，建议您使用异步；其他情况下可以使用折中的方案，即半同步

7. binlog

   Binlog写满500MB就会生成新的Binlog日志文件继续写入，同时会根据本地备份设置将备份日志上传到OSS，并清理本地日志

   可以从控制台下载binlog，然后用mysqlbinlog查看日志