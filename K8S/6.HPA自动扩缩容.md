# HPA自动扩缩容

Horizontal Pod Autoscaler：Pod的水平自动伸缩器

观察Pod的CPU、内存使用率来自动扩缩Pod数量

不适用无法缩放的对象，比如DaemonSet

必须定义requests参数，必须安装metrics-server

运行hpa资源，名称为demo-nginx，当deployment资源对象的cpu使用率达到百分之20就进行扩容，最小2个，最多5个

```shell
kubectl autoscale deploy demo-nginx --cpu-percent=20 --min=2 --max=5
```

模拟并发请求

```shell
[root@node01 ~]# while true; do wget -q -O- 10.97.45.108; done              #一直返回ok属于正常现象
```

查看hpa资源对cpu的占用情况

```shell
kubectl get hpa
kubectl get top
```

